var multiRoute={mapObject:null,trafficLayer:null,directionsDisplay:null,lineColor:null,j:null,marker:null,myOptions:null,initialize:function(){$("#map").attr("traffic","off"),myOptions={zoom:12,center:new google.maps.LatLng(-6.205855,106.839131),mapTypeId:google.maps.MapTypeId.ROADMAP},mapObject=new google.maps.Map(document.getElementById("map"),myOptions),trafficLayer=new google.maps.TrafficLayer},trafficActive:function(){var e=$("#map").attr("traffic");"off"==e?(trafficLayer.setMap(mapObject),$("#map").attr("traffic","on")):(trafficLayer.setMap(null),$("#map").attr("traffic","off"))},getPosition:function(){function e(e){multiRoute.geocode({lat:e.coords.latitude,lng:e.coords.longitude})}navigator.geolocation?navigator.geolocation.getCurrentPosition(e,multiRoute.showerror):"object"==typeof google&&google.loader.ClientLocation&&multiRoute.geocode({lat:google.loader.ClientLocation.latitude,lng:google.loader.ClientLocation.longitude})},geocode:function(e){latLng=new google.maps.LatLng(e.lat,e.lng),multiRoute.geocoder.geocode({latLng:latLng},function(e,t){t==google.maps.GeocoderStatus.OK?(console.log(e[0].formatted_address),document.getElementById("from").value=e[0].formatted_address):alert("Geocode not success because: "+t)})},showMultiRoute:function(){mapObject=new google.maps.Map(document.getElementById("map"),myOptions);var e,t=new google.maps.DirectionsService;lineColor=new Array("#B334B2","#2E63B4","#45F01A","#C94E4E","#4D4444","#4B25D6","#138C2B","#F8F52A","#2AF8EA","#B334B2","#2E63B4","#45F01A","#C94E4E","#4D4444","#4B25D6","#138C2B","#F8F52A","#2AF8EA","#B334B2","#2E63B4","#45F01A","#C94E4E","#4D4444","#4B25D6","#138C2B","#F8F52A","#2AF8EA");var o=$("#from").val(),a=$("#to").val(),n=[],r="",i="",l=0,s=0,c="",p="",d=1;if($("#route").html(""),$("#route").append('<div><button onClick="window.print();">Print</button></div>'),$('input[name="toWaypoints[]"]').each(function(){n.push($(this).val())}),s=n.length+1,1>=s)e={origin:o,destination:a,provideRouteAlternatives:!0,travelMode:google.maps.DirectionsTravelMode.DRIVING,unitSystem:google.maps.UnitSystem.METRIC},t.route(e,function(e,t){if(t==google.maps.DirectionsStatus.OK){var o=e.routes[0].legs[0];c="https://chart.googleapis.com/chart?chst=d_map_xpin_icon&chld=pin_star|car-dealer|00FFFF|FF0000",p="https://chart.googleapis.com/chart?chst=d_map_pin_icon&chld=flag|ADDE63",multiRoute.makeMarker(o.start_location,mapObject,c,o.start_address),multiRoute.makeMarker(o.end_location,mapObject,p,o.end_address);for(var a=0,n=e.routes.length;n>a;a++)d++,directionsDisplay=new google.maps.DirectionsRenderer({map:mapObject,suppressMarkers:!0,polylineOptions:{strokeColor:lineColor[d],strokeOpacity:.7,strokeWeight:7},directions:e,routeIndex:a}),directionsDisplay.setPanel(document.getElementById("route")),j=a+1}else alert("Unable to retrieve your route")});else for(var m=0;s>m;m++)0==m?(r=o,i=n[m]):m==s-1?(r=i,i=a):(r=i,i=n[m]),l=m+1,e={origin:r,destination:i,provideRouteAlternatives:!0,travelMode:google.maps.DirectionsTravelMode.DRIVING,unitSystem:google.maps.UnitSystem.METRIC},t.route(e,function(e,t){if(t==google.maps.DirectionsStatus.OK){var o=e.routes[0].legs[0];c="https://chart.googleapis.com/chart?chst=d_map_xpin_icon&chld=pin_star|car-dealer|00FFFF|FF0000",p="https://chart.googleapis.com/chart?chst=d_map_pin_icon&chld=flag|ADDE63",multiRoute.makeMarker(o.start_location,mapObject,c,o.start_address),multiRoute.makeMarker(o.end_location,mapObject,p,o.end_address);for(var a=0,n=e.routes.length;n>a;a++)directionsDisplay=new google.maps.DirectionsRenderer({map:mapObject,suppressMarkers:!0,polylineOptions:{strokeColor:lineColor[d],strokeOpacity:.7,strokeWeight:7},directions:e,routeIndex:a}),directionsDisplay.setPanel(document.getElementById("route")),j=a+1,d++}else alert("Unable to retrieve your route")})},makeMarker:function(e,t,o,a){marker=new google.maps.Marker({position:e,map:t,icon:o,title:a})},addWaypoints:function(){var e='<div class="waypointsAdded"><label for="from" class="col-sm-2 control-label">From</label>';e+='<div class="col-sm-10">',e+='<input type="text" name="toWaypoints[]" class="form-control" id="from" placeholder="Type an Address">',e+='<a href="#" onclick="multiRoute.addWaypoints()">Add Waypoints</a> &nbsp;',e+='<a href="#" onclick="multiRoute.deleteWaypoints(this)">Remove</a>',e+="</div></div>",$("#waypoints").append(e)},deleteWaypoints:function(e){return $(e).parent().parent().remove(),!1},showPanel:function(e){$(".adp-list:eq("+e+")").slideDown(),$(".adp:eq("+e+")").slideDown(),$(".adp-list").not(":eq("+e+")").slideUp(),$(".adp").not(":eq("+e+")").slideUp()},showerror:function(e){switch(e.code){case e.TIMEOUT:alert("Timeout");break;case e.POSITION_UNAVAILABLE:alert("Position unavailable");break;case e.PERMISSION_DENIED:alert("Permission denied.");break;case e.UNKNOWN_ERROR:alert("Unknown error")}}};